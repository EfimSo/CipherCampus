# zk-Merkle Utilities

A collection of Python and TypeScript scripts (plus accompanying data files) for constructing, verifying, and manipulating Merkle trees using Aztec’s Barretenberg library and standard data formats.

---

## Table of Contents

* [Description](#description)
* [Prerequisites](#prerequisites)
* [Installation](#installation)

  * [Python](#python)
  * [Node.js & TypeScript](#nodejs--typescript)
* [Files & Data](#files--data)
* [Usage](#usage)

  * [Python Scripts](#python-scripts)
  * [TypeScript Scripts](#typescript-scripts)
* [Dependencies](#dependencies)
* [Contributing](#contributing)
* [License](#license)

---

## Description

This repository provides:

* **Python utilities** for parsing and transforming course datasets and key files
* **TypeScript tools** for building full Merkle trees, computing proofs, and deriving roots
* **Sample CSV/JSON/TXT keys** and PEM files used as inputs/outputs

Use cases include academic ledger verification, zero-knowledge proof demos, and blockchain data integrity checks.

---

## Prerequisites

* **Python** 3.8 or higher
* **Node.js** 16.x or higher (bundles `npm`)

---

## Installation

### Python

1. Create and activate a virtual environment:

   ```bash
   python3 -m venv venv
   source venv/bin/activate   # Windows: venv\\Scripts\\activate
   ```
2. Upgrade pip and install packages:

   ```bash
   pip install --upgrade pip
   pip install pandas cryptography
   ```

### Node.js & TypeScript

1. Initialize npm (if not already initialized):

   ```bash
   npm init -y
   ```
2. Install runtime dependencies and dev tools:

   ```bash
   npm install @aztec/bb.js csv-parse msgpackr
   npm install --save-dev typescript ts-node
   ```
3. (Optional) Generate `tsconfig.json` for stricter typing:

   ```bash
   npx tsc --init
   ```

---

## Files & Data

| Filename                           | Description                                                |
| ---------------------------------- | ---------------------------------------------------------- |
| `courses.csv`                      | Raw course listing source                                  |
| `courses_assigned.csv`             | CSV used to build Merkle tree (merkle leaves)              |
| `public_keys.txt`                  | Plain-text ECC public key blocks (input to `parse_pks.py`) |
| `parsed_keys.json`                 | JSON key output from `parse_pks.py`                        |
| `private_keys.pem`                 | PEM‑encoded private keys (for decryption/encryption tasks) |
| `full_tree.json`                   | Merkle tree dump generated by `build_full_merkle_tree.ts`  |
| `parsed_keys.json`                 | JSON result of splitting 256‑bit coordinates               |
| `package.json`/`package-lock.json` | NPM manifests for TS dependencies                          |

---

## Usage

### Python Scripts

#### `modify_courses.py`

Modify and transform course listings CSVs (e.g., `courses.csv` → `courses_assigned.csv`).

```bash
python modify_courses.py \
  --input courses.csv \
  --output courses_assigned.csv
```

#### `parse_pks.py`

Parse ECC public keys from `public_keys.txt` into a 256‑bit split JSON (`parsed_keys.json`).

```bash
python parse_pks.py \
  --input public_keys.txt \
  --output parsed_keys.json
```

### TypeScript Scripts

> All TS commands assume `ts-node` is installed.

#### `build_full_merkle_tree.ts`

Reads `courses_assigned.csv`, builds a full Merkle tree, and writes the dump to `full_tree.json`.

```bash
npm run build-tree -- \
  --input courses_assigned.csv \
  --output full_tree.json
```

#### `compute_proof.ts`

Generates a Merkle proof (TOML snippet) for a record at given index in `courses_assigned.csv`.

```bash
npm run compute-proof -- \
  --input courses_assigned.csv \
  --index 0
```

#### `compute_root_from_json.ts`

Computes the Merkle root from an existing `full_tree.json` dump.

```bash
npm run compute-root -- \
  --input full_tree.json
```

---

## Dependencies

**Python**

* `pandas>=1.0.0`
* `cryptography>=3.4.7`

**Node.js**

* `@aztec/bb.js@^0.86.0`
* `csv-parse@^5.6.0`
* `msgpackr@^1.11.2`
* Dev: `typescript`, `ts-node`

---
